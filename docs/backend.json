{
  "entities": {
    "MenuItem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MenuItem",
      "type": "object",
      "description": "Represents a dish or item on the menu.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the menu item."
        },
        "name": {
          "type": "string",
          "description": "Name of the dish."
        },
        "price": {
          "type": "number",
          "description": "Price of the dish."
        },
        "category": {
          "type": "string",
          "description": "Category of the dish (e.g., appetizer, main course)."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the image for the dish.",
          "format": "uri"
        },
        "tags": {
          "type": "array",
          "description": "Tags associated with the dish (e.g., vegetarian, spicy).",
          "items": {
            "type": "string"
          }
        },
        "isAvailable": {
          "type": "boolean",
          "description": "Indicates if the dish is currently available."
        }
      },
      "required": [
        "id",
        "name",
        "price",
        "category",
        "imageUrl",
        "isAvailable"
      ]
    },
    "Order": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Order",
      "type": "object",
      "description": "Represents a customer order.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the order."
        },
        "menuItemIds": {
          "type": "array",
          "description": "References to MenuItems in this order. (Relationship: Order 1:N MenuItem)",
          "items": {
            "type": "string"
          }
        },
        "orderDate": {
          "type": "string",
          "description": "Date and time when the order was placed.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "Current status of the order (e.g., received, preparing, ready, completed)."
        },
        "workerId": {
          "type": "string",
          "description": "Reference to Worker. (Relationship: Worker 1:N Order)"
        },
        "quantity": {
          "type": "number",
          "description": "The amount of items of this type."
        }
      },
      "required": [
        "id",
        "menuItemIds",
        "orderDate",
        "status",
        "workerId",
        "quantity"
      ]
    },
    "Worker": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Worker",
      "type": "object",
      "description": "Represents a kitchen worker.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the worker."
        },
        "name": {
          "type": "string",
          "description": "Name of the worker."
        },
        "role": {
          "type": "string",
          "description": "Role of the worker (e.g., cook, server)."
        }
      },
      "required": [
        "id",
        "name",
        "role"
      ]
    },
    "Admin": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Admin",
      "type": "object",
      "description": "Represents an administrator user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the admin."
        },
        "name": {
          "type": "string",
          "description": "Name of the administrator."
        },
        "email": {
          "type": "string",
          "description": "Email address of the administrator.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "name",
        "email"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/menu_items/{menuItemId}",
        "definition": {
          "entityName": "MenuItem",
          "schema": {
            "$ref": "#/backend/entities/MenuItem"
          },
          "description": "Stores information about each menu item. Only admins can create, update, or delete menu items.",
          "params": [
            {
              "name": "menuItemId",
              "description": "Unique identifier for the menu item."
            }
          ]
        }
      },
      {
        "path": "/workers/{workerId}",
        "definition": {
          "entityName": "Worker",
          "schema": {
            "$ref": "#/backend/entities/Worker"
          },
          "description": "Stores worker information. Used for authentication and assigning orders.",
          "params": [
            {
              "name": "workerId",
              "description": "Unique identifier for the worker."
            }
          ]
        }
      },
      {
        "path": "/workers/{workerId}/orders/{orderId}",
        "definition": {
          "entityName": "Order",
          "schema": {
            "$ref": "#/backend/entities/Order"
          },
          "description": "Stores order information associated with a specific worker. Includes the `workerId` for authorization.",
          "params": [
            {
              "name": "workerId",
              "description": "Unique identifier for the worker."
            },
            {
              "name": "orderId",
              "description": "Unique identifier for the order."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{adminId}",
        "definition": {
          "entityName": "Admin",
          "schema": {
            "$ref": "#/backend/entities/Admin"
          },
          "description": "Indicates that a user is an administrator. Existence of a document at this path grants admin privileges. Used for login validation.",
          "params": [
            {
              "name": "adminId",
              "description": "Unique identifier for the admin."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support a Food App Management Portal with distinct Admin and Worker interfaces. The structure prioritizes authorization independence and simple security rules. Admins and workers are modeled using distinct collections to ensure security. Menu items are stored in a top-level collection, while orders are associated with specific workers to track order assignments. The structure uses explicit collections for roles (admins and workers) and path-based ownership where applicable.\n\n*   **Authorization Independence:** No `get()` calls are required for authorization. Roles are checked by existence in the `/roles_admin/{uid}` and `/workers/{workerId}` collections. This avoids hierarchical dependencies.\n*   **Clarity of Intent:** The structure clearly separates admin and worker data, making authorization intent explicit.\n*   **DBAC (Database Auth):** Roles are stored in the database (`/roles_admin/{uid}`, `/workers/{workerId}`), relying solely on `request.auth.uid` for authorization.\n*   **QAPs (Rules are not Filters):** The segregated structure enables secure `list` operations. Only admins can list all menu items, while workers can only access their assigned orders.  The structure supports listing all menu items for the admin portal without needing to filter based on accessibility.\n*   **Invariants:** The structure supports ownership via the `workerId` field in the `Order` document, ensuring orders are always associated with a worker. Timestamps (`orderDate`) and denormalized data can be easily added/managed as needed."
  }
}